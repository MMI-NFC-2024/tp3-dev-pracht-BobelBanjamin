---
import Layout from "../layouts/Layout.astro";
---

<Layout>
  <div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-center mb-8">Visualisation par Iframe</h1>
    
    <nav class="mb-8">
      <ul class="flex space-x-6 justify-center bg-gray-100 p-4 rounded-lg">
        <li><a href="/species/Adelie" target="species-frame" class="text-blue-600 hover:text-blue-800 transition-colors">Adelie</a></li>
        <li><a href="/species/Gentoo" target="species-frame" class="text-blue-600 hover:text-blue-800 transition-colors">Gentoo</a></li>
        <li><a href="/species/Chinstrap" target="species-frame" class="text-blue-600 hover:text-blue-800 transition-colors">Chinstrap</a></li>
        <li><span class="text-gray-400">|</span></li>
        <li><a href="/" class="text-gray-600 hover:text-blue-600 transition-colors">Accueil</a></li>
        <li><a href="/anchors" class="text-gray-600 hover:text-blue-600 transition-colors">Ancres</a></li>
      </ul>
    </nav>
    
    <div class="border-2 border-gray-200 rounded-lg overflow-hidden shadow-lg">
      <iframe 
        name="species-frame" 
        src="/speciesi-frame/Adelieiframe" 
        class="w-full"
        style="height: 600px; border: none;"
        id="species-iframe"
        onload="resizeIframe(this)">
      </iframe>
    </div>
    
    <div class="mt-8 bg-blue-50 p-6 rounded-lg">
      <h3 class="text-lg font-semibold mb-3">Navigation par Iframe</h3>
      <p class="text-gray-700">
        Cette page utilise une iframe pour afficher les différentes espèces de manchots. 
        Cliquez sur les liens du menu pour charger les différentes pages dans l'iframe ci-dessus.
        L'iframe se redimensionne automatiquement selon le contenu.
      </p>
    </div>
  </div>
</Layout>

<script>
  function resizeIframe(iframe) {
    try {
      // Attendre un peu pour que le contenu soit complètement chargé
      setTimeout(() => {
        const iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
        const height = Math.max(
          iframeDocument.body.scrollHeight,
          iframeDocument.body.offsetHeight,
          iframeDocument.documentElement.clientHeight,
          iframeDocument.documentElement.scrollHeight,
          iframeDocument.documentElement.offsetHeight
        );
        iframe.style.height = Math.max(height + 50, 600) + 'px';
      }, 100);
    } catch (e) {
      // En cas d'erreur (cross-origin par exemple), garder la hauteur par défaut
      iframe.style.height = '600px';
    }
  }
  
  // Redimensionner également au changement de contenu
  window.addEventListener('message', function(e) {
    if (e.data.type === 'resize') {
      const iframe = document.getElementById('species-iframe');
      if (iframe) {
        resizeIframe(iframe);
      }
    }
  });
</script>